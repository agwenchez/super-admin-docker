{"ast":null,"code":"import _toConsumableArray from\"/Users/agwenchez/Desktop/Afya Kwanza/Admin Dashboard/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/agwenchez/Desktop/Afya Kwanza/Admin Dashboard/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Fragment,useState,useEffect,forwardRef}from'react';import{Container}from'reactstrap';import{Grid,Button}from'@material-ui/core/';import MaterialTable from\"material-table\";import{AddBox,ArrowDownward,Check,ChevronLeft,ChevronRight,Clear,DeleteOutline,Edit,FilterList,FirstPage,LastPage,Remove,ViewColumn,SaveAlt,Search}from\"@material-ui/icons\";import axios from'axios';import{useHistory}from\"react-router-dom\";// import Alert from '@material-ui/lab/Alert';\nimport{toast}from'react-toastify';import Modal from'./MemberModal/modal';// import { Delete } from 'react-feather';\nvar tableIcons={Add:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(Button,Object.assign({},props,{ref:ref,variant:\"contained\",color:\"primary\"}),\"Add New\");}),// Add: () => <Button variant=\"contained\" color=\"primary\" >Add New</Button> ,\nCheck:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(Check,Object.assign({},props,{ref:ref}));}),Clear:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(Clear,Object.assign({},props,{ref:ref}));}),Delete:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(DeleteOutline,Object.assign({},props,{ref:ref}));}),DetailPanel:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(ChevronRight,Object.assign({},props,{ref:ref}));}),Edit:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(Edit,Object.assign({},props,{ref:ref}));}),Export:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(SaveAlt,Object.assign({},props,{ref:ref}));}),Filter:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(FilterList,Object.assign({},props,{ref:ref}));}),FirstPage:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(FirstPage,Object.assign({},props,{ref:ref}));}),LastPage:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(LastPage,Object.assign({},props,{ref:ref}));}),NextPage:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(ChevronRight,Object.assign({},props,{ref:ref}));}),PreviousPage:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(ChevronLeft,Object.assign({},props,{ref:ref}));}),ResetSearch:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(Clear,Object.assign({},props,{ref:ref}));}),Search:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(Search,Object.assign({},props,{ref:ref}));}),SortArrow:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(ArrowDownward,Object.assign({},props,{ref:ref}));}),ThirdStateCheck:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(Remove,Object.assign({},props,{ref:ref}));}),ViewColumn:forwardRef(function(props,ref){return/*#__PURE__*/React.createElement(ViewColumn,Object.assign({},props,{ref:ref}));})};var api=axios.create({baseURL:\"http://localhost:4000\"});function validateEmail(email){var re=/^((?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\]))$/;return re.test(String(email).toLowerCase());}var MembersTable=function MembersTable(_ref){var setAuth=_ref.setAuth;var columns=[{title:\"id\",field:\"id\",hidden:true},// { title: \"Avatar\", render: rowData => <Avatar maxInitials={1} size={40} round={true} name={rowData === undefined ? \" \" : rowData.first_name} /> },\n{title:\"Name\",field:\"name\"},{title:\"Email\",field:\"email\"},{title:\"Phone No\",field:\"phonenumber\"},{title:\"Location\",field:\"location\"},{title:\"Sacco\",field:\"sacco\"},{title:\"Insruance Plan\",field:\"insurance_plan\"}];var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];//table data\nvar _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),riders=_useState4[0],setRiders=_useState4[1];//for error handling\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),iserror=_useState6[0],setIserror=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),errorMessages=_useState8[0],setErrorMessages=_useState8[1];useEffect(function(){api.get('/members/all').then(function(res){// console.log(\"data =>\", res.data)\nsetRiders(res.data);// console.log(\"riders =>\", riders)\n}).catch(function(error){console.log(\"Error\",error);});},[]);var handleRowUpdate=function handleRowUpdate(newData,oldData,resolve){//validation\n// console.log(newData)\nvar errorList=[];if(newData.name===undefined){errorList.push(\"Please enter a name\");}if(newData.email===undefined){errorList.push(\"Please enter an email\");}if(newData.phonenumber===undefined){errorList.push(\"Please enter a phone number\");}if(newData.location===undefined){errorList.push(\"Please enter a location\");}if(newData.sacco===undefined){errorList.push(\"Please enter a sacco name\");}if(newData.insurance_plan===undefined){errorList.push(\"Please enter an insurance plan\");}if(errorList.length<1){// console.log(newData.member_id)\napi.put(\"/members/update/\"+newData.member_id,newData).then(function(res){// console.log(\"New data=>\",newData)\nvar dataUpdate=_toConsumableArray(riders);var index=oldData.tableData.id;dataUpdate[index]=newData;setRiders(_toConsumableArray(dataUpdate));console.log(\"Response status ==>\",res.status);if(res.status==201){toast.success(res.data);}resolve();setIserror(false);setErrorMessages([]);}).catch(function(error){setErrorMessages([\"Update failed: \".concat(error)]);toast.error(\"Update failed: \".concat(error));setIserror(true);resolve();});}else{setErrorMessages(errorList);setIserror(true);resolve();}};var handleRowDelete=function handleRowDelete(oldData,resolve){api.delete(\"/members/delete/\"+oldData.member_id).then(function(res){var dataDelete=_toConsumableArray(riders);var index=oldData.tableData.id;dataDelete.splice(index,1);setRiders(_toConsumableArray(dataDelete));// alert(res.data)\n// console.log(\"API Response\",res)\nif(res.status==200){toast.success(res.data);}resolve();}).catch(function(error){console.log(error);toast.error(\"Delete failed:\".concat(error));setIserror(true);resolve();});};var history=useHistory();return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(Container,{fluid:true},/*#__PURE__*/React.createElement(\"div\",{style:{width:'100%'}},/*#__PURE__*/React.createElement(\"h3\",{style:{paddingTop:'5%',marginBottom:'2.5%',textAlign:'center'}},\"Sacco Members Table\"),/*#__PURE__*/React.createElement(Grid,{container:true,spacing:10},/*#__PURE__*/React.createElement(Grid,{item:true,xs:\"2\"}),/*#__PURE__*/React.createElement(Grid,{item:true,xs:\"2\"}),/*#__PURE__*/React.createElement(Grid,{item:true,xs:\"2\"}),/*#__PURE__*/React.createElement(Grid,{item:true,xs:\"2\"}),/*#__PURE__*/React.createElement(Grid,{item:true,xs:\"2\"}),/*#__PURE__*/React.createElement(Grid,{item:true,xs:\"2\"},/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){history.push('/dashboard/members/new');},variant:\"contained\",color:\"primary\"},\"Add New\"))),/*#__PURE__*/React.createElement(Grid,{container:true,spacing:1,style:{marginBottom:'6%'}},/*#__PURE__*/React.createElement(Grid,{item:true,xs:12}),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(MaterialTable,{title:\"Sacco Members\",style:{zIndex:'0'},columns:columns,data:riders,icons:tableIcons,editable:{onRowUpdate:function onRowUpdate(newData,oldData){return new Promise(function(resolve){handleRowUpdate(newData,oldData,resolve);});},onRowDelete:function onRowDelete(oldData){return new Promise(function(resolve){handleRowDelete(oldData,resolve);});}},options:{exportButton:true,selection:true,// filtering: true,\nactionsColumnIndex:-1,search:true,paginationType:'normal',pageSize:10,pageSizeOptions:[25,50,100,200,300,400,500,600,700]},actions:[{tooltip:'Remove All Selected Users',icon:DeleteOutline,onClick:function onClick(evt,data){return alert('You want to delete '+data.length+' rows');}}]}))))));};export default MembersTable;","map":{"version":3,"sources":["/Users/agwenchez/Desktop/Afya Kwanza/Admin Dashboard/client/src/components/new/MembersTable.jsx"],"names":["React","Fragment","useState","useEffect","forwardRef","Container","Grid","Button","MaterialTable","AddBox","ArrowDownward","Check","ChevronLeft","ChevronRight","Clear","DeleteOutline","Edit","FilterList","FirstPage","LastPage","Remove","ViewColumn","SaveAlt","Search","axios","useHistory","toast","Modal","tableIcons","Add","props","ref","Delete","DetailPanel","Export","Filter","NextPage","PreviousPage","ResetSearch","SortArrow","ThirdStateCheck","api","create","baseURL","validateEmail","email","re","test","String","toLowerCase","MembersTable","setAuth","columns","title","field","hidden","data","setData","riders","setRiders","iserror","setIserror","errorMessages","setErrorMessages","get","then","res","catch","error","console","log","handleRowUpdate","newData","oldData","resolve","errorList","name","undefined","push","phonenumber","location","sacco","insurance_plan","length","put","member_id","dataUpdate","index","tableData","id","status","success","handleRowDelete","delete","dataDelete","splice","history","width","paddingTop","marginBottom","textAlign","zIndex","onRowUpdate","Promise","onRowDelete","exportButton","selection","actionsColumnIndex","search","paginationType","pageSize","pageSizeOptions","tooltip","icon","onClick","evt","alert"],"mappings":"4WAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,QAA1B,CAAoCC,SAApC,CAA+CC,UAA/C,KAAiE,OAAjE,CACA,OAASC,SAAT,KAA0B,YAA1B,CACA,OAASC,IAAT,CAAeC,MAAf,KAA6B,oBAA7B,CACA,MAAOC,CAAAA,aAAP,KAA0B,gBAA1B,CACA,OAASC,MAAT,CAAiBC,aAAjB,CAAgCC,KAAhC,CAAuCC,WAAvC,CAAoDC,YAApD,CAAkEC,KAAlE,CAAyEC,aAAzE,CAAwFC,IAAxF,CAA8FC,UAA9F,CAA0GC,SAA1G,CAAqHC,QAArH,CAA+HC,MAA/H,CAAuIC,UAAvI,CAAmJC,OAAnJ,CAA4JC,MAA5J,KAA0K,oBAA1K,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA;AACA,OAASC,KAAT,KAAsB,gBAAtB,CACA,MAAOC,CAAAA,KAAP,KAAkB,qBAAlB,CAEA;AAGA,GAAMC,CAAAA,UAAU,CAAG,CACjBC,GAAG,CAAEzB,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,MAAD,kBAAYD,KAAZ,EAAmB,GAAG,CAAEC,GAAxB,CAA6B,OAAO,CAAC,WAArC,CAAiD,KAAK,CAAC,SAAvD,aAAhB,EAAD,CADE,CAEjB;AACApB,KAAK,CAAEP,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,KAAD,kBAAWD,KAAX,EAAkB,GAAG,CAAEC,GAAvB,GAAhB,EAAD,CAHA,CAIjBjB,KAAK,CAAEV,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,KAAD,kBAAWD,KAAX,EAAkB,GAAG,CAAEC,GAAvB,GAAhB,EAAD,CAJA,CAKjBC,MAAM,CAAE5B,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,aAAD,kBAAmBD,KAAnB,EAA0B,GAAG,CAAEC,GAA/B,GAAhB,EAAD,CALD,CAMjBE,WAAW,CAAE7B,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,YAAD,kBAAkBD,KAAlB,EAAyB,GAAG,CAAEC,GAA9B,GAAhB,EAAD,CANN,CAOjBf,IAAI,CAAEZ,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,IAAD,kBAAUD,KAAV,EAAiB,GAAG,CAAEC,GAAtB,GAAhB,EAAD,CAPC,CAQjBG,MAAM,CAAE9B,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,OAAD,kBAAaD,KAAb,EAAoB,GAAG,CAAEC,GAAzB,GAAhB,EAAD,CARD,CASjBI,MAAM,CAAE/B,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,UAAD,kBAAgBD,KAAhB,EAAuB,GAAG,CAAEC,GAA5B,GAAhB,EAAD,CATD,CAUjBb,SAAS,CAAEd,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,SAAD,kBAAeD,KAAf,EAAsB,GAAG,CAAEC,GAA3B,GAAhB,EAAD,CAVJ,CAWjBZ,QAAQ,CAAEf,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,QAAD,kBAAcD,KAAd,EAAqB,GAAG,CAAEC,GAA1B,GAAhB,EAAD,CAXH,CAYjBK,QAAQ,CAAEhC,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,YAAD,kBAAkBD,KAAlB,EAAyB,GAAG,CAAEC,GAA9B,GAAhB,EAAD,CAZH,CAajBM,YAAY,CAAEjC,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,WAAD,kBAAiBD,KAAjB,EAAwB,GAAG,CAAEC,GAA7B,GAAhB,EAAD,CAbP,CAcjBO,WAAW,CAAElC,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,KAAD,kBAAWD,KAAX,EAAkB,GAAG,CAAEC,GAAvB,GAAhB,EAAD,CAdN,CAejBR,MAAM,CAAEnB,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,MAAD,kBAAYD,KAAZ,EAAmB,GAAG,CAAEC,GAAxB,GAAhB,EAAD,CAfD,CAgBjBQ,SAAS,CAAEnC,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,aAAD,kBAAmBD,KAAnB,EAA0B,GAAG,CAAEC,GAA/B,GAAhB,EAAD,CAhBJ,CAiBjBS,eAAe,CAAEpC,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,MAAD,kBAAYD,KAAZ,EAAmB,GAAG,CAAEC,GAAxB,GAAhB,EAAD,CAjBV,CAkBjBV,UAAU,CAAEjB,UAAU,CAAC,SAAC0B,KAAD,CAAQC,GAAR,qBAAgB,oBAAC,UAAD,kBAAgBD,KAAhB,EAAuB,GAAG,CAAEC,GAA5B,GAAhB,EAAD,CAlBL,CAAnB,CAsBA,GAAMU,CAAAA,GAAG,CAAGjB,KAAK,CAACkB,MAAN,CAAa,CACvBC,OAAO,wBADgB,CAAb,CAAZ,CAIA,QAASC,CAAAA,aAAT,CAAuBC,KAAvB,CAA8B,CAC5B,GAAMC,CAAAA,EAAE,CAAG,gbAAX,CACA,MAAOA,CAAAA,EAAE,CAACC,IAAH,CAAQC,MAAM,CAACH,KAAD,CAAN,CAAcI,WAAd,EAAR,CAAP,CACD,CAED,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,MAAe,IAAbC,CAAAA,OAAa,MAAbA,OAAa,CAElC,GAAIC,CAAAA,OAAO,CAAG,CACZ,CAAEC,KAAK,CAAE,IAAT,CAAeC,KAAK,CAAE,IAAtB,CAA4BC,MAAM,CAAE,IAApC,CADY,CAEZ;AACA,CAAEF,KAAK,CAAE,MAAT,CAAiBC,KAAK,CAAE,MAAxB,CAHY,CAIZ,CAAED,KAAK,CAAE,OAAT,CAAkBC,KAAK,CAAE,OAAzB,CAJY,CAKZ,CAAED,KAAK,CAAE,UAAT,CAAqBC,KAAK,CAAE,aAA5B,CALY,CAMZ,CAAED,KAAK,CAAE,UAAT,CAAqBC,KAAK,CAAE,UAA5B,CANY,CAOZ,CAAED,KAAK,CAAE,OAAT,CAAkBC,KAAK,CAAE,OAAzB,CAPY,CAQZ,CAAED,KAAK,CAAE,gBAAT,CAA2BC,KAAK,CAAE,gBAAlC,CARY,CAAd,CAFkC,cAaVpD,QAAQ,CAAC,EAAD,CAbE,wCAa3BsD,IAb2B,eAarBC,OAbqB,eAaI;AAbJ,eAcRvD,QAAQ,CAAC,EAAD,CAdA,yCAc3BwD,MAd2B,eAcpBC,SAdoB,eAgBlC;AAhBkC,eAiBJzD,QAAQ,CAAC,KAAD,CAjBJ,yCAiB3B0D,OAjB2B,eAiBlBC,UAjBkB,8BAkBQ3D,QAAQ,CAAC,EAAD,CAlBhB,yCAkB3B4D,aAlB2B,eAkBZC,gBAlBY,eAoBlC5D,SAAS,CAAC,UAAM,CACZsC,GAAG,CAACuB,GAAJ,CAAQ,cAAR,EACCC,IADD,CACO,SAAAC,GAAG,CAAE,CACR;AACAP,SAAS,CAACO,GAAG,CAACV,IAAL,CAAT,CACA;AACD,CALH,EAMEW,KANF,CAMQ,SAAAC,KAAK,CAAI,CACfC,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBF,KAArB,EACD,CARD,EAUH,CAXQ,CAWN,EAXM,CAAT,CAcA,GAAMG,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACC,OAAD,CAAUC,OAAV,CAAmBC,OAAnB,CAA+B,CACrD;AACA;AACA,GAAIC,CAAAA,SAAS,CAAG,EAAhB,CACA,GAAGH,OAAO,CAACI,IAAR,GAAiBC,SAApB,CAA8B,CAC5BF,SAAS,CAACG,IAAV,CAAe,qBAAf,EACD,CACD,GAAGN,OAAO,CAAC3B,KAAR,GAAkBgC,SAArB,CAA+B,CAC7BF,SAAS,CAACG,IAAV,CAAe,uBAAf,EACD,CACD,GAAGN,OAAO,CAACO,WAAR,GAAwBF,SAA3B,CAAqC,CACnCF,SAAS,CAACG,IAAV,CAAe,6BAAf,EACD,CACD,GAAGN,OAAO,CAACQ,QAAR,GAAqBH,SAAxB,CAAkC,CAChCF,SAAS,CAACG,IAAV,CAAe,yBAAf,EACD,CACD,GAAGN,OAAO,CAACS,KAAR,GAAkBJ,SAArB,CAA+B,CAC7BF,SAAS,CAACG,IAAV,CAAe,2BAAf,EACD,CACD,GAAGN,OAAO,CAACU,cAAR,GAA0BL,SAA7B,CAAuC,CACrCF,SAAS,CAACG,IAAV,CAAe,gCAAf,EACD,CAGD,GAAIH,SAAS,CAACQ,MAAV,CAAmB,CAAvB,CAA0B,CACxB;AACA1C,GAAG,CAAC2C,GAAJ,CAAQ,mBAAmBZ,OAAO,CAACa,SAAnC,CAA8Cb,OAA9C,EACGP,IADH,CACQ,SAAAC,GAAG,CAAI,CACX;AACA,GAAMoB,CAAAA,UAAU,oBAAO5B,MAAP,CAAhB,CACA,GAAM6B,CAAAA,KAAK,CAAGd,OAAO,CAACe,SAAR,CAAkBC,EAAhC,CACAH,UAAU,CAACC,KAAD,CAAV,CAAoBf,OAApB,CACAb,SAAS,oBAAK2B,UAAL,EAAT,CACAjB,OAAO,CAACC,GAAR,CAAY,qBAAZ,CAAkCJ,GAAG,CAACwB,MAAtC,EACA,GAAGxB,GAAG,CAACwB,MAAJ,EAAc,GAAjB,CAAqB,CACnBhE,KAAK,CAACiE,OAAN,CAAczB,GAAG,CAACV,IAAlB,EACD,CACDkB,OAAO,GACPb,UAAU,CAAC,KAAD,CAAV,CACAE,gBAAgB,CAAC,EAAD,CAAhB,CACD,CAdH,EAeGI,KAfH,CAeS,SAAAC,KAAK,CAAI,CACdL,gBAAgB,CAAC,0BAAmBK,KAAnB,EAAD,CAAhB,CACA1C,KAAK,CAAC0C,KAAN,0BAA8BA,KAA9B,GACAP,UAAU,CAAC,IAAD,CAAV,CACAa,OAAO,GAER,CArBH,EAsBD,CAxBD,IAwBO,CACLX,gBAAgB,CAACY,SAAD,CAAhB,CACAd,UAAU,CAAC,IAAD,CAAV,CACAa,OAAO,GAER,CAEF,CAvDD,CA0DA,GAAMkB,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACnB,OAAD,CAAUC,OAAV,CAAsB,CAC5CjC,GAAG,CAACoD,MAAJ,CAAW,mBAAoBpB,OAAO,CAACY,SAAvC,EACGpB,IADH,CACQ,SAAAC,GAAG,CAAI,CACX,GAAM4B,CAAAA,UAAU,oBAAOpC,MAAP,CAAhB,CACA,GAAM6B,CAAAA,KAAK,CAAGd,OAAO,CAACe,SAAR,CAAkBC,EAAhC,CACAK,UAAU,CAACC,MAAX,CAAkBR,KAAlB,CAAyB,CAAzB,EACA5B,SAAS,oBAAKmC,UAAL,EAAT,CACA;AACA;AACA,GAAG5B,GAAG,CAACwB,MAAJ,EAAc,GAAjB,CAAqB,CACnBhE,KAAK,CAACiE,OAAN,CAAczB,GAAG,CAACV,IAAlB,EACD,CACDkB,OAAO,GACR,CAZH,EAaGP,KAbH,CAaS,SAAAC,KAAK,CAAI,CACdC,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACA1C,KAAK,CAAC0C,KAAN,yBAA6BA,KAA7B,GACAP,UAAU,CAAC,IAAD,CAAV,CACAa,OAAO,GACR,CAlBH,EAmBD,CApBD,CAsBF,GAAMsB,CAAAA,OAAO,CAAGvE,UAAU,EAA1B,CAGE,mBACE,oBAAC,QAAD,mBACE,oBAAC,SAAD,EAAW,KAAK,CAAE,IAAlB,eACE,2BAAK,KAAK,CAAE,CAAEwE,KAAK,CAAE,MAAT,CAAZ,eAEE,0BAAI,KAAK,CAAE,CAAEC,UAAU,CAAE,IAAd,CAAoBC,YAAY,CAAE,MAAlC,CAA0CC,SAAS,CAAE,QAArD,CAAX,wBAFF,cAGE,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,OAAO,CAAE,EAAzB,eACI,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAC,GAAd,EADJ,cAEI,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAC,GAAd,EAFJ,cAGI,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAC,GAAd,EAHJ,cAII,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAC,GAAd,EAJJ,cAKI,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAC,GAAd,EALJ,cAMI,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAC,GAAd,eACE,oBAAC,MAAD,EAAQ,OAAO,CAAE,kBAAI,CAAEJ,OAAO,CAAClB,IAAR,CAAa,wBAAb,EAAuC,CAA9D,CAAiE,OAAO,CAAC,WAAzE,CAAqF,KAAK,CAAC,SAA3F,YADF,CANJ,CAHF,cAiBE,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,OAAO,CAAE,CAAzB,CAA4B,KAAK,CAAE,CAACqB,YAAY,CAAC,IAAd,CAAnC,eACE,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,EAAf,EADF,cAEE,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,EAAf,eAUE,oBAAC,aAAD,EACE,KAAK,CAAC,eADR,CAEE,KAAK,CAAE,CAACE,MAAM,CAAE,GAAT,CAFT,CAGE,OAAO,CAAEjD,OAHX,CAIE,IAAI,CAAEM,MAJR,CAKE,KAAK,CAAE9B,UALT,CAME,QAAQ,CAAE,CACR0E,WAAW,CAAE,qBAAC9B,OAAD,CAAUC,OAAV,QACX,IAAI8B,CAAAA,OAAJ,CAAY,SAAC7B,OAAD,CAAa,CACvBH,eAAe,CAACC,OAAD,CAAUC,OAAV,CAAmBC,OAAnB,CAAf,CAED,CAHD,CADW,EADL,CAMR8B,WAAW,CAAE,qBAAC/B,OAAD,QACX,IAAI8B,CAAAA,OAAJ,CAAY,SAAC7B,OAAD,CAAa,CACvBkB,eAAe,CAACnB,OAAD,CAAUC,OAAV,CAAf,CACD,CAFD,CADW,EANL,CANZ,CAiBE,OAAO,CAAE,CACP+B,YAAY,CAAE,IADP,CAEPC,SAAS,CAAE,IAFJ,CAGP;AACAC,kBAAkB,CAAE,CAAC,CAJd,CAKPC,MAAM,CAAE,IALD,CAMPC,cAAc,CAAE,QANT,CAOPC,QAAQ,CAAE,EAPH,CAQPC,eAAe,CAAC,CAAC,EAAD,CAAI,EAAJ,CAAO,GAAP,CAAW,GAAX,CAAe,GAAf,CAAmB,GAAnB,CAAuB,GAAvB,CAA2B,GAA3B,CAA+B,GAA/B,CART,CAjBX,CA2BE,OAAO,CAAE,CACP,CACEC,OAAO,CAAE,2BADX,CAEEC,IAAI,CAAElG,aAFR,CAGEmG,OAAO,CAAE,iBAACC,GAAD,CAAM3D,IAAN,QAAe4D,CAAAA,KAAK,CAAC,sBAAwB5D,IAAI,CAAC2B,MAA7B,CAAsC,OAAvC,CAApB,EAHX,CADO,CA3BX,EAVF,CAFF,CAjBF,CADF,CADF,CADF,CA2ED,CAhMD,CAkMA,cAAejC,CAAAA,YAAf","sourcesContent":["import React, { Fragment, useState, useEffect, forwardRef } from 'react';\nimport { Container } from 'reactstrap'\nimport { Grid, Button } from '@material-ui/core/'\nimport MaterialTable from \"material-table\";\nimport { AddBox, ArrowDownward, Check, ChevronLeft, ChevronRight, Clear, DeleteOutline, Edit, FilterList, FirstPage, LastPage, Remove, ViewColumn, SaveAlt, Search } from \"@material-ui/icons\";\nimport axios from 'axios';\nimport { useHistory } from \"react-router-dom\";\n// import Alert from '@material-ui/lab/Alert';\nimport { toast } from 'react-toastify';\nimport Modal from './MemberModal/modal';\n\n// import { Delete } from 'react-feather';\n\n\nconst tableIcons = {\n  Add: forwardRef((props, ref) => <Button {...props} ref={ref} variant=\"contained\" color=\"primary\" >Add New</Button> ),\n  // Add: () => <Button variant=\"contained\" color=\"primary\" >Add New</Button> ,\n  Check: forwardRef((props, ref) => <Check {...props} ref={ref} />),\n  Clear: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\n  Delete: forwardRef((props, ref) => <DeleteOutline {...props} ref={ref} />),\n  DetailPanel: forwardRef((props, ref) => <ChevronRight {...props} ref={ref} />),\n  Edit: forwardRef((props, ref) => <Edit {...props} ref={ref} />),\n  Export: forwardRef((props, ref) => <SaveAlt {...props} ref={ref} />),\n  Filter: forwardRef((props, ref) => <FilterList {...props} ref={ref} />),\n  FirstPage: forwardRef((props, ref) => <FirstPage {...props} ref={ref} />),\n  LastPage: forwardRef((props, ref) => <LastPage {...props} ref={ref} />),\n  NextPage: forwardRef((props, ref) => <ChevronRight {...props} ref={ref} />),\n  PreviousPage: forwardRef((props, ref) => <ChevronLeft {...props} ref={ref} />),\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref} />),\n  SortArrow: forwardRef((props, ref) => <ArrowDownward {...props} ref={ref} />),\n  ThirdStateCheck: forwardRef((props, ref) => <Remove {...props} ref={ref} />),\n  ViewColumn: forwardRef((props, ref) => <ViewColumn {...props} ref={ref} />)\n};\n\n\nconst api = axios.create({\n  baseURL: `http://localhost:4000`\n})\n\nfunction validateEmail(email) {\n  const re = /^((?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\]))$/;\n  return re.test(String(email).toLowerCase());\n}\n\nconst MembersTable = ({setAuth}) => {\n\n  var columns = [\n    { title: \"id\", field: \"id\", hidden: true },\n    // { title: \"Avatar\", render: rowData => <Avatar maxInitials={1} size={40} round={true} name={rowData === undefined ? \" \" : rowData.first_name} /> },\n    { title: \"Name\", field: \"name\"},\n    { title: \"Email\", field: \"email\"},\n    { title: \"Phone No\", field: \"phonenumber\" },\n    { title: \"Location\", field: \"location\" },\n    { title: \"Sacco\", field: \"sacco\" },\n    { title: \"Insruance Plan\", field: \"insurance_plan\" },\n\n  ]\n  const [data, setData] = useState([]); //table data\n  const [riders,setRiders]= useState([])\n\n  //for error handling\n  const [iserror, setIserror] = useState(false)\n  const [errorMessages, setErrorMessages] = useState([])\n\n  useEffect(() => {\n      api.get('/members/all')\n      .then( res=>{\n          // console.log(\"data =>\", res.data)\n          setRiders(res.data)\n          // console.log(\"riders =>\", riders)\n        }\n      ).catch(error => {\n        console.log(\"Error\", error)\n      })\n      \n  }, [])\n\n\n  const handleRowUpdate = (newData, oldData, resolve) => {\n    //validation\n    // console.log(newData)\n    let errorList = []\n    if(newData.name === undefined){\n      errorList.push(\"Please enter a name\")\n    }\n    if(newData.email === undefined){\n      errorList.push(\"Please enter an email\")\n    }\n    if(newData.phonenumber === undefined){\n      errorList.push(\"Please enter a phone number\")\n    }\n    if(newData.location === undefined){\n      errorList.push(\"Please enter a location\")\n    }\n    if(newData.sacco === undefined){\n      errorList.push(\"Please enter a sacco name\")\n    }\n    if(newData.insurance_plan=== undefined){\n      errorList.push(\"Please enter an insurance plan\")\n    }\n\n\n    if (errorList.length < 1) {\n      // console.log(newData.member_id)\n      api.put(\"/members/update/\"+newData.member_id, newData)\n        .then(res => {\n          // console.log(\"New data=>\",newData)\n          const dataUpdate = [...riders];\n          const index = oldData.tableData.id;\n          dataUpdate[index] = newData;\n          setRiders([...dataUpdate]);\n          console.log(\"Response status ==>\",res.status);\n          if(res.status == 201){\n            toast.success(res.data)\n          }\n          resolve()\n          setIserror(false)\n          setErrorMessages([])\n        })\n        .catch(error => {\n          setErrorMessages([`Update failed: ${error}`])\n          toast.error(`Update failed: ${error}`);\n          setIserror(true)\n          resolve()\n\n        })\n    } else {\n      setErrorMessages(errorList)\n      setIserror(true)\n      resolve()\n\n    }\n\n  }\n\n\n  const handleRowDelete = (oldData, resolve) => {\n    api.delete(\"/members/delete/\"+ oldData.member_id)\n      .then(res => {\n        const dataDelete = [...riders];\n        const index = oldData.tableData.id;\n        dataDelete.splice(index, 1);\n        setRiders([...dataDelete]);\n        // alert(res.data)\n        // console.log(\"API Response\",res)\n        if(res.status == 200){\n          toast.success(res.data)\n        }\n        resolve()\n      })\n      .catch(error => {\n        console.log(error)\n        toast.error(`Delete failed:${error}`)\n        setIserror(true)\n        resolve()\n      })\n  }\n\nconst history = useHistory();\n\n\n  return (\n    <Fragment>\n      <Container fluid={true}>\n        <div style={{ width: '100%'}}>\n          \n          <h3 style={{ paddingTop: '5%', marginBottom: '2.5%', textAlign: 'center' }}>Sacco Members Table</h3>\n          <Grid container spacing={10}>\n              <Grid item xs=\"2\"></Grid>\n              <Grid item xs=\"2\"></Grid>\n              <Grid item xs=\"2\"></Grid>\n              <Grid item xs=\"2\"></Grid>\n              <Grid item xs=\"2\"></Grid>\n              <Grid item xs=\"2\">\n                <Button onClick={()=>{ history.push('/dashboard/members/new')} } variant=\"contained\" color=\"primary\" >\n                  Add New\n                </Button>\n              </Grid>\n         </Grid>\n         \n          {/* <Modal /> */}\n          <Grid container spacing={1} style={{marginBottom:'6%'}}>\n            <Grid item xs={12}></Grid>\n            <Grid item xs={12}>\n              {/* <div>\n                {iserror &&\n                  <Alert severity=\"error\">\n                    {errorMessages.map((msg, i) => {\n                      return <div key={i}>{msg}</div>\n                    })}\n                  </Alert>\n                }\n              </div> */}\n              <MaterialTable\n                title=\"Sacco Members\"\n                style={{zIndex: '0'}}\n                columns={columns}\n                data={riders}\n                icons={tableIcons}\n                editable={{\n                  onRowUpdate: (newData, oldData) =>\n                    new Promise((resolve) => {\n                      handleRowUpdate(newData, oldData, resolve);\n\n                    }),\n                  onRowDelete: (oldData) =>\n                    new Promise((resolve) => {\n                      handleRowDelete(oldData, resolve)\n                    }),\n                }}\n                options={{\n                  exportButton: true,\n                  selection: true,\n                  // filtering: true,\n                  actionsColumnIndex: -1,\n                  search: true,\n                  paginationType: 'normal',\n                  pageSize: 10,\n                  pageSizeOptions:[25,50,100,200,300,400,500,600,700]\n                }}\n                actions={[\n                  {\n                    tooltip: 'Remove All Selected Users',\n                    icon: DeleteOutline,\n                    onClick: (evt, data) => alert('You want to delete ' + data.length + ' rows')\n                  }\n                ]}\n\n              />\n            </Grid>\n           \n          </Grid>\n        </div>\n      </Container>\n    </Fragment>\n  );\n}\n\nexport default MembersTable;"]},"metadata":{},"sourceType":"module"}